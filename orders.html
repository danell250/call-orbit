<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CallOrbit â€” Buy Numbers & Plans</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><circle cx='32' cy='32' r='30' fill='%233b82f6'/></svg>">
<style>
body { font-family: 'Inter', sans-serif; background:#f9fafb; color:#1f2937; margin:0; padding:0; }
nav {display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:#fff;box-shadow:0 2px 10px rgba(0,0,0,0.05);}
nav a {margin-left:15px;text-decoration:none;color:#1f2937;font-weight:500;}
.nav-right {display:flex;align-items:center;gap:15px;position:relative;}
/* Cart dropdown */
#cart-dropdown {display:none;position:fixed;bottom:70px;right:20px;width:400px;height:500px;background:#fff;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.2);padding:15px;z-index:1001;transition:all 0.3s;overflow-y:auto;}
#cart-dropdown.active {display:block;}
.cart-item {display:flex;flex-direction:column;margin-bottom:12px;padding-bottom:10px;border-bottom:1px solid #e5e7eb;}
.cart-item div {margin:2px 0;}
.remove-btn {background:#ef4444;color:#fff;border:none;padding:4px 8px;border-radius:5px;cursor:pointer;align-self:flex-end;margin-top:5px;}
.quantity-input {width:60px;padding:4px;border:1px solid #d1d5db;border-radius:5px;background:#fff;}
.cart-summary {margin-top:15px;text-align:right;font-weight:600;font-size:1rem;position:sticky;bottom:70px;background:#fff;padding-top:10px;}
#paypal-button-container {margin-top:10px;position:sticky;bottom:0;background:#fff;padding-top:10px;}
/* Scrollbar for cart */
#cart-items {max-height:350px; overflow-y:auto;}
/* Plans */
main{max-width:1120px;margin:20px auto;padding:0}
header.hero{margin:20px auto;padding:60px 20px;text-align:center;background:linear-gradient(135deg,#3b82f6,#60a5fa);color:#fff;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,0.1);}
header.hero h1{margin-bottom:1rem;font-size:2.5rem}
header.hero p{margin-bottom:2rem;font-size:1.25rem}
.plans-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin:20px 0;padding:0 10px}
.plan{background:#fff;padding:20px;border-radius:1rem;box-shadow:0 5px 20px rgba(0,0,0,0.05);text-align:center;transition:transform .2s;cursor:pointer}
.plan:hover{transform:translateY(-5px)}
.plan h3{color:#1e3a8a;margin-bottom:1rem}
.plan .price,.plan .minutes,.plan .overage{margin-bottom:0.5rem}
.forwarding{margin:20px 10px;background:#fff;padding:20px;border-radius:1rem;box-shadow:0 5px 20px rgba(0,0,0,0.05);display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;align-items:end}
.forwarding label{display:block;margin-bottom:0.5rem;font-weight:600}
.forwarding select,.forwarding input{width:100%;padding:0.75rem;margin-bottom:1rem;border:1px solid #d1d5db;border-radius:0.5rem;font-size:1rem}
.buy-now{background:#3b82f6;color:#fff;padding:12px 24px;border:none;border-radius:999px;font-weight:700;font-size:1rem;cursor:pointer;transition:filter .2s;margin-top:10px}
.buy-now:hover{filter:brightness(0.95)}
</style>
</head>
<body>
<nav>
<div><a href="/"><strong>CallOrbit</strong></a></div>
<div class="nav-right">
<a href="/">Home</a>
<a href="/features">Features</a>
<a href="/pricing">Pricing</a>
<a href="/coverage">Coverage</a>
<a href="/platform">Platform</a>
<a href="/contact">Contact</a>
<a href="/about">About</a>
<a href="/login">Login</a>
</div>
</nav>
<header class="hero">
<h1>Get Started with CallOrbit</h1>
<p>Select your plan, country, number type, area (for local numbers), and forwarding number to start using your CallOrbit portal.</p>
</header>
<main>
<div class="forwarding">
<div>
<label for="country">Select Country</label>
<select id="country"></select>
</div>
<div>
<label for="number-type">Number Type</label>
<select id="number-type">
<option value="tollFree">Toll-Free</option>
<option value="local">Local</option>
<option value="national">National</option>
</select>
</div>
<div id="area-container" style="display:none">
<label for="area">Select Area</label>
<select id="area"></select>
</div>
<div style="grid-column:1/-1">
<label for="forward">Forwarding Number / Device</label>
<input type="text" id="forward" placeholder="+27 10 500 1234 or SIP URI">
</div>
</div>
<div class="plans-grid" id="plans-container"></div>
</main>
<!-- Cart dropdown stays hidden by default, can be used by buttons -->
<div id="cart-dropdown">
<div id="cart-items"></div>
<div class="cart-summary">
<div>Subtotal: $<span id="cart-subtotal">0.00</span></div>
<div>VAT: $<span id="cart-vat">0.00</span></div>
<div>Total: $<span id="cart-total">0.00</span></div>
</div>
<div id="paypal-button-container"></div>
</div>
<footer style="text-align:center;padding:2rem;background:#f3f4f6;margin-top:20px;">
&copy; <span id="year"></span> CallOrbit. All rights reserved. <br>
<a href="/privacy-policy" style="margin:0 10px;color:#3b82f6;text-decoration:none;">Privacy Policy</a>
<a href="/terms-conditions" style="margin:0 10px;color:#3b82f6;text-decoration:none;">Terms & Conditions</a>
<a href="/refund-policy" style="margin:0 10px;color:#3b82f6;text-decoration:none;">Refund Policy</a>
</footer>
<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>
<script>
document.getElementById('year').textContent = new Date().getFullYear();
const countries=["US","GB","CA","AU","DE","FR","IN","ZA","BR","MX","JP","IT","ES","NL","CH","SE","SG","IE","NZ","NO","PT","BE","KR","TR","TH","PH","TW","PL","RO","HU"];
const countryNames={US:"United States",GB:"United Kingdom",CA:"Canada",AU:"Australia",DE:"Germany",FR:"France",IN:"India",ZA:"South Africa",BR:"Brazil",MX:"Mexico",JP:"Japan",IT:"Italy",ES:"Spain",NL:"Netherlands",CH:"Switzerland",SE:"Sweden",SG:"Singapore",IE:"Ireland",NZ:"New Zealand",NO:"Norway",PT:"Portugal",BE:"Belgium",KR:"South Korea",TR:"Turkey",TH:"Thailand",PH:"Philippines",TW:"Taiwan",PL:"Poland",RO:"Romania",HU:"Hungary"};
const localAreas={US:["New York","Los Angeles","Chicago","Houston","Miami"],GB:["London","Manchester","Birmingham"],CA:["Toronto","Vancouver","Montreal"],AU:["Sydney","Melbourne","Brisbane"],DE:["Berlin","Munich","Hamburg"],FR:["Paris","Lyon","Marseille"],IN:["Mumbai","Delhi","Bangalore"],ZA:["Johannesburg","Cape Town","Durban"],BR:["Sao Paulo","Rio de Janeiro","Brasilia"],MX:["Mexico City","Guadalajara","Monterrey"],JP:["Tokyo","Osaka","Nagoya"],IT:["Rome","Milan","Naples"],ES:["Madrid","Barcelona","Valencia"],NL:["Amsterdam","Rotterdam","The Hague"],CH:["Zurich","Geneva"],SE:["Stockholm","Gothenburg"],SG:["Singapore"],IE:["Dublin","Cork"],NZ:["Auckland","Wellington"],NO:["Oslo","Bergen"],PT:["Lisbon","Porto"],BE:["Brussels","Antwerp"],KR:["Seoul","Busan"],TR:["Istanbul","Ankara"],TH:["Bangkok","Chiang Mai"],PH:["Manila","Cebu"],TW:["Taipei","Kaohsiung"],PL:["Warsaw","Krakow"],RO:["Bucharest","Cluj"],HU:["Budapest","Debrecen"]};
const packages={Basic:100,Plus:500,Pro:1000,Max:2500};
const countryData={US:{tollFree:0.05,local:0.03,national:0.04},GB:{tollFree:0.06,local:0.04,national:0.05},CA:{tollFree:0.05,local:0.03,national:0.04},AU:{tollFree:0.06,local:0.04,national:0.05},DE:{tollFree:0.07,local:0.05,national:0.06},FR:{tollFree:0.07,local:0.05,national:0.06},IN:{tollFree:0.04,local:0.02,national:0.03},ZA:{tollFree:0.05,local:0.03,national:0.04},BR:{tollFree:0.06,local:0.04,national:0.05},MX:{tollFree:0.05,local:0.03,national:0.04},JP:{tollFree:0.08,local:0.06,national:0.07},IT:{tollFree:0.07,local:0.05,national:0.06},ES:{tollFree:0.07,local:0.05,national:0.06},NL:{tollFree:0.06,local:0.04,national:0.05},CH:{tollFree:0.08,local:0.06,national:0.07},SE:{tollFree:0.06,local:0.04,national:0.05},SG:{tollFree:0.07,local:0.05,national:0.06},IE:{tollFree:0.06,local:0.04,national:0.05},NZ:{tollFree:0.06,local:0.04,national:0.05},NO:{tollFree:0.07,local:0.05,national:0.06},PT:{tollFree:0.07,local:0.05,national:0.06},BE:{tollFree:0.07,local:0.05,national:0.06},KR:{tollFree:0.08,local:0.06,national:0.07},TR:{tollFree:0.06,local:0.04,national:0.05},TH:{tollFree:0.05,local:0.03,national:0.04},PH:{tollFree:0.04,local:0.02,national:0.03},TW:{tollFree:0.07,local:0.05,national:0.06},PL:{tollFree:0.06,local:0.04,national:0.05},RO:{tollFree:0.06,local:0.04,national:0.05},HU:{tollFree:0.06,local:0.04,national:0.05}};

const countrySelectEl=document.getElementById('country');
const plansContainerEl=document.getElementById('plans-container');
countries.forEach(c=>{
    const opt=document.createElement('option');
    opt.value=c;
    opt.textContent=countryNames[c];
    countrySelectEl.appendChild(opt);
});

let cart = [];
const cartDropdown = document.getElementById('cart-dropdown');
const cartItemsEl = document.getElementById('cart-items');
const cartSubtotalEl = document.getElementById('cart-subtotal');
const cartVatEl = document.getElementById('cart-vat');
const cartTotalEl = document.getElementById('cart-total');

function generatePlans(){
    const country=countrySelectEl.value;
    const numberType=document.getElementById('number-type').value;
    const areaContainer=document.getElementById('area-container');
    const areaSelect=document.getElementById('area');
    if(numberType==='local'){
        areaContainer.style.display='block';
        areaSelect.innerHTML='';
        localAreas[country].forEach(a=>{
            const opt=document.createElement('option');
            opt.value=a;
            opt.textContent=a;
            areaSelect.appendChild(opt);
        });
    } else {
        areaContainer.style.display='none';
    }
    plansContainerEl.innerHTML='';
    Object.keys(packages).forEach(pkg=>{
        const mins=packages[pkg];
        const rate=countryData[country][numberType];
        const price=+(rate*mins*1.25).toFixed(2);
        const div=document.createElement('div');
        div.className='plan';
        div.dataset.monthly=price;
        div.dataset.minutes=mins;
        div.dataset.overage=(rate*1.25).toFixed(3);
        div.innerHTML=`<h3>${pkg}</h3>
        <div class="price">$${price}</div>
        <div class="minutes">${mins} Minutes, Monthly Subscription</div>
        <div class="overage">Overage: $${(rate*1.25).toFixed(3)}/min</div>
        <button class="buy-now">Add to Cart</button>`;
        plansContainerEl.appendChild(div);
    });
}

function updateCartDisplay(){
    cartItemsEl.innerHTML='';
    let subtotal=0;
    cart.forEach((item,i)=>{
        subtotal+=item.price*item.quantity;
        const div=document.createElement('div');
        div.className='cart-item';
        div.innerHTML=`
        <strong>${item.name}</strong>
        <div>$${item.price.toFixed(2)} x <input type="number" class="quantity-input" data-index="${i}" value="${item.quantity}" min="1"></div>
        <div>${item.minutes} Minutes, Monthly Subscription</div>
        <div>Overage: $${item.overage}/min</div>
        <button class="remove-btn" data-index="${i}">Remove</button>`;
        cartItemsEl.appendChild(div);
    });
    const vat=+(subtotal*0.15).toFixed(2);
    const total=+(subtotal+vat).toFixed(2);
    cartSubtotalEl.textContent=subtotal.toFixed(2);
    cartVatEl.textContent=vat.toFixed(2);
    cartTotalEl.textContent=total.toFixed(2);
    localStorage.setItem('cart', JSON.stringify(cart));

    if (!window.paypalRendered) {
        paypal.Buttons({
            style:{layout:'vertical', color:'blue', shape:'pill', label:'pay'},
            createOrder: function(data, actions){ return actions.order.create({purchase_units:[{amount:{value:total.toFixed(2)}}]}); },
            onApprove: function(data, actions){
                return actions.order.capture().then(function(details){
                    alert('Transaction completed by ' + details.payer.name.given_name);
                    cart = [];
                    updateCartDisplay();
                });
            }
        }).render('#paypal-button-container');
        window.paypalRendered = true;
    }
}

countrySelectEl.addEventListener('change',generatePlans);
document.getElementById('number-type').addEventListener('change',generatePlans);

plansContainerEl.addEventListener('click', e=>{
    if(e.target.classList.contains('buy-now')){
        const planDiv = e.target.closest('.plan');
        cart.push({
            name: planDiv.querySelector('h3').textContent,
            price: parseFloat(planDiv.dataset.monthly),
            minutes: planDiv.dataset.minutes,
            overage: planDiv.dataset.overage,
            quantity:1
        });
        updateCartDisplay();
    }
});

cartItemsEl.addEventListener('click', e=>{
    if(e.target.classList.contains('remove-btn')){
        const index = e.target.dataset.index;
        cart.splice(index,1);
        updateCartDisplay();
    }
});

cartItemsEl.addEventListener('input', e=>{
    if(e.target.classList.contains('quantity-input')){
        const index = e.target.dataset.index;
        cart[index].quantity = parseInt(e.target.value);
        updateCartDisplay();
    }
});

generatePlans();

// --- New script to read cart from localStorage on order page ---
document.addEventListener('DOMContentLoaded', () => {
    const savedCart = JSON.parse(localStorage.getItem('cart') || '[]');
    if(savedCart.length > 0){
        cart = savedCart;
        updateCartDisplay();
    }
});
</script>
<script src="js/cart.js"></script>
</body>
</html>
