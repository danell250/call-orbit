<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CallOrbit — Orders</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="data:image/svg+xml,
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>
    <circle cx='32' cy='32' r='30' fill='%233b82f6'/>
  </svg>">
  <script src="https://www.paypal.com/sdk/js?client-id=AZj-lkjSMiruqhm64d7ZET-1K7Kv4YLo8IuJn_0ikbzNU3oR91hnmQN2l8uQXNyYYgOb0gqlv5aLM94N&currency=USD"></script>
  <style>
    /* Orders Page Specific */
    main { max-width:1120px; margin:auto; padding:20px; }
    .plan { border:1px solid #e2e8f0; border-radius:14px; padding:16px; margin-bottom:16px; background:#fff; transition: transform 0.2s; }
    .plan:hover { transform: translateY(-3px); }
    .plan h3 { margin:0 0 8px; color:#1e3a8a; }
    .price, .minutes, .overage { margin-bottom:4px; }
    .select-plan { margin-top:10px; background:#22c55e; color:#fff; font-weight:700; border:none; border-radius:10px; padding:10px; cursor:pointer; }
    .select-plan:hover { filter:brightness(.95); }
    .forward-input { margin-top:8px; width:100%; padding:8px; border-radius:8px; border:1px solid #cbd5e1; }
    /* Cart */
    #cart { position: fixed; top:0; right:-400px; width:350px; height:100%; background:#fff; box-shadow:-5px 0 25px rgba(0,0,0,0.15); padding:20px; transition:right 0.3s; z-index:1000; overflow-y:auto; }
    #cart.visible { right:0; }
    #cart h2 { margin-top:0; }
    .cart-item { border-bottom:1px solid #e2e8f0; padding:10px 0; }
    .cart-total { font-weight:700; margin-top:10px; }
    .checkout-btn { width:100%; background:#1e3a8a; color:#fff; padding:10px; font-weight:700; border-radius:10px; margin-top:10px; cursor:pointer; border:none; }
    .checkout-btn:hover { filter:brightness(.95); }
  </style>
</head>
<body>
  <nav>
    <div><a href="/"><strong>CallOrbit</strong></a></div>
    <div>
      <a href="/" >Home</a>
      <a href="/features">Features</a>
      <a href="/pricing">Pricing</a>
      <a href="/about">About</a>
      <a href="/contact">Contact</a>
      <a href="/coverage">Coverage</a>
      <a href="/platform">Platform</a>
      <a href="/orders.html" class="active-page">Orders</a>
    </div>
  </nav>

  <header class="hero fade-in center">
    <h1>Buy Your Plans & Numbers</h1>
    <p>Select a plan, forwarding country, and number to get started.</p>
  </header>

  <main id="plans-container">
    <!-- Plans will be dynamically injected -->
  </main>

  <!-- Cart -->
  <div id="cart">
    <h2>Cart</h2>
    <div id="cart-items"></div>
    <div class="cart-total">Total: $<span id="cart-total">0.00</span></div>
    <button class="checkout-btn" id="checkout-btn">Checkout</button>
  </div>

  <footer>
    &copy; <span id="year"></span> CallOrbit. All rights reserved.
  </footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

// --- Country & Rates Data (partial example, extend all countries) ---
const countries = [
  {name:"United States", fixed:0.01, mobile:0.03},
  {name:"United Kingdom", fixed:0.02, mobile:0.04},
  {name:"South Africa", fixed:0.015, mobile:0.035},
  {name:"India", fixed:0.01, mobile:0.02},
  {name:"Australia", fixed:0.02, mobile:0.04},
  // add all other countries except North Korea
];

// --- Plans ---
const plans = [
  {id:"basic", name:"Basic", basePrice:16.99, includedMinutes:100, overage:0.32},
  {id:"plus", name:"Plus", basePrice:25.99, includedMinutes:156, overage:0.316},
  {id:"pro", name:"Pro", basePrice:43.99, includedMinutes:215, overage:0.307},
  {id:"max", name:"Max", basePrice:70.99, includedMinutes:346, overage:0.304},
];

// --- Render Plans ---
const plansContainer = document.getElementById('plans-container');
plans.forEach(plan=>{
  const div = document.createElement('div');
  div.className="plan";
  div.innerHTML=`
    <h3>${plan.name}</h3>
    <div class="price">$${plan.basePrice.toFixed(2)}/mo</div>
    <div class="minutes">${plan.includedMinutes} included minutes</div>
    <div class="overage">Overage: $${plan.overage.toFixed(3)}/min</div>
    <label>Country
      <select class="forward-country">
        ${countries.map(c=>`<option value="${c.name}" data-fixed="${c.fixed}" data-mobile="${c.mobile}">${c.name}</option>`).join('')}
      </select>
    </label>
    <label>Forwarding Number
      <input type="text" class="forward-input" placeholder="+27 10 500 1234 or SIP URI">
    </label>
    <div>Fixed rate: $<span class="fixed-rate">${countries[0].fixed}</span>/min, Mobile rate: $<span class="mobile-rate">${countries[0].mobile}</span>/min</div>
    <button class="select-plan">Add to Cart</button>
  `;
  plansContainer.appendChild(div);

  const countrySelect = div.querySelector('.forward-country');
  const fixedRateEl = div.querySelector('.fixed-rate');
  const mobileRateEl = div.querySelector('.mobile-rate');
  countrySelect.addEventListener('change', ()=>{
    const selected = countrySelect.selectedOptions[0];
    fixedRateEl.textContent = selected.dataset.fixed;
    mobileRateEl.textContent = selected.dataset.mobile;
  });
});

// --- Cart Functionality ---
let cart = [];
const cartEl = document.getElementById('cart');
const cartItemsEl = document.getElementById('cart-items');
const cartTotalEl = document.getElementById('cart-total');

document.querySelectorAll('.select-plan').forEach((btn,i)=>{
  btn.addEventListener('click', ()=>{
    const planDiv = btn.closest('.plan');
    const planName = planDiv.querySelector('h3').textContent;
    const country = planDiv.querySelector('.forward-country').value;
    const forwardNumber = planDiv.querySelector('.forward-input').value || '—';
    const fixedRate = parseFloat(planDiv.querySelector('.fixed-rate').textContent);
    const mobileRate = parseFloat(planDiv.querySelector('.mobile-rate').textContent);
    const price = plans[i].basePrice;

    cart.push({planName, country, forwardNumber, price, fixedRate, mobileRate});
    updateCart();
  });
});

function updateCart(){
  cartItemsEl.innerHTML="";
  let total=0;
  cart.forEach((item,idx)=>{
    total+=item.price;
    const div = document.createElement('div');
    div.className="cart-item";
    div.innerHTML=`
      <strong>${item.planName}</strong><br>
      Country: ${item.country}<br>
      Forwarding: ${item.forwardNumber}<br>
      Fixed: $${item.fixedRate}/min, Mobile: $${item.mobileRate}/min<br>
      Price: $${item.price.toFixed(2)}
    `;
    cartItemsEl.appendChild(div);
  });
  cartTotalEl.textContent=total.toFixed(2);
  if(cart.length>0) cartEl.classList.add('visible');
  else cartEl.classList.remove('visible');
}

// --- Checkout ---
document.getElementById('checkout-btn').addEventListener('click', ()=>{
  if(cart.length===0) return;
  // Redirect to PayPal using "Buy Now" for each item (simplified)
  // For real integration, create one PayPal transaction with total
  const total = cart.reduce((sum,i)=>sum+i.price,0).toFixed(2);
  const paypalUrl = `https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=YOUR_PAYPAL_EMAIL&amount=${total}&currency_code=USD&item_name=CallOrbit Plans`;
  window.location.href = paypalUrl;
});
</script>
</body>
</html>
